# -*- coding: utf-8 -*-
# snapshottest: v1 - https://goo.gl/zC4yUc
from __future__ import unicode_literals

from snapshottest import Snapshot


snapshots = Snapshot()

snapshots['test_sql[ SELECT * EXCLUDE (timestamp_tz) REPLACE (varchar.replace(chr(0), chr(10)) AS whatever) FROM test_all_types() ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=8,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](
                    root=[
                        Pair[str, ParsedExpressionSubclasses](
                            key='whatever',
                            value=ParsedExpressionSubclasses(
                                root=FunctionExpression(
                                    query_location=42,
                                    type='FUNCTION',
                                    clazz='FUNCTION',
                                    alias='',
                                    schema_name='varchar',
                                    function_name='replace',
                                    catalog='',
                                    is_operator=False,
                                    children=[
                                        ParsedExpressionSubclasses(
                                            root=FunctionExpression(
                                                query_location=58,
                                                type='FUNCTION',
                                                clazz='FUNCTION',
                                                alias='',
                                                schema_name='',
                                                function_name='chr',
                                                catalog='',
                                                is_operator=False,
                                                children=[
                                                    ParsedExpressionSubclasses(
                                                        root=ConstantExpression(
                                                            query_location=62,
                                                            type='VALUE_CONSTANT',
                                                            clazz='CONSTANT',
                                                            alias='',
                                                            value=Value(
                                                                query_location=None,
                                                                type=LogicalType(
                                                                    query_location=None,
                                                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                                    type_info=None
                                                                ),
                                                                value=0,
                                                                is_null=False
                                                            )
                                                        )
                                                    )
                                                ],
                                                distinct=False,
                                                order_bys=OrderModifier(
                                                    query_location=None,
                                                    type='ORDER_MODIFIER',
                                                    orders=[]
                                                ),
                                                export_state=False,
                                                filter=None
                                            )
                                        ),
                                        ParsedExpressionSubclasses(
                                            root=FunctionExpression(
                                                query_location=66,
                                                type='FUNCTION',
                                                clazz='FUNCTION',
                                                alias='',
                                                schema_name='',
                                                function_name='chr',
                                                catalog='',
                                                is_operator=False,
                                                children=[
                                                    ParsedExpressionSubclasses(
                                                        root=ConstantExpression(
                                                            query_location=70,
                                                            type='VALUE_CONSTANT',
                                                            clazz='CONSTANT',
                                                            alias='',
                                                            value=Value(
                                                                query_location=None,
                                                                type=LogicalType(
                                                                    query_location=None,
                                                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                                    type_info=None
                                                                ),
                                                                value=10,
                                                                is_null=False
                                                            )
                                                        )
                                                    )
                                                ],
                                                distinct=False,
                                                order_bys=OrderModifier(
                                                    query_location=None,
                                                    type='ORDER_MODIFIER',
                                                    orders=[]
                                                ),
                                                export_state=False,
                                                filter=None
                                            )
                                        )
                                    ],
                                    distinct=False,
                                    order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                                    export_state=False,
                                    filter=None
                                )
                            )
                        )
                    ]
                ),
                relation_name='',
                exclude_list=['timestamp_tz'],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=TableFunctionRef(
            query_location=93,
            alias='',
            sample=None,
            type='TABLE_FUNCTION',
            function=FunctionExpression(
                query_location=93,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='test_all_types',
                catalog='',
                is_operator=False,
                children=[],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            ),
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[ SELECT * FROM grades grades_parent WHERE grade= (SELECT MIN(grade) FROM grades WHERE grades.course=grades_parent.course); ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=16,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                relation_name='',
                exclude_list=[],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=ParsedExpressionSubclasses(
        root=ComparisonExpression(
            query_location=71,
            type='COMPARE_EQUAL',
            clazz='COMPARISON',
            alias='',
            left=ParsedExpressionSubclasses(
                root=ColumnRefExpression(
                    query_location=66,
                    type='COLUMN_REF',
                    clazz='COLUMN_REF',
                    alias='',
                    column_names=['grade']
                )
            ),
            right=ParsedExpressionSubclasses(
                root=SubqueryExpression(
                    query_location=85,
                    type='SUBQUERY',
                    clazz='SUBQUERY',
                    alias='',
                    child=None,
                    comparison_type='INVALID',
                    subquery=SelectStatement(
                        query_location=None,
                        node=QueryNodeSubclasses(
                            root=SelectNode(
                                query_location=None,
                                type='SELECT_NODE',
                                modifiers=[],
                                cte_map=CommonTableExpressionMap(
                                    query_location=None,
                                    map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                                ),
                                select_list=[
                                    ParsedExpressionSubclasses(
                                        root=FunctionExpression(
                                            query_location=93,
                                            type='FUNCTION',
                                            clazz='FUNCTION',
                                            alias='',
                                            schema_name='',
                                            function_name='min',
                                            catalog='',
                                            is_operator=False,
                                            children=[
                                                ParsedExpressionSubclasses(
                                                    root=ColumnRefExpression(
                                                        query_location=97,
                                                        type='COLUMN_REF',
                                                        clazz='COLUMN_REF',
                                                        alias='',
                                                        column_names=['grade']
                                                    )
                                                )
                                            ],
                                            distinct=False,
                                            order_bys=OrderModifier(
                                                query_location=None,
                                                type='ORDER_MODIFIER',
                                                orders=[]
                                            ),
                                            export_state=False,
                                            filter=None
                                        )
                                    )
                                ],
                                where_clause=ParsedExpressionSubclasses(
                                    root=ComparisonExpression(
                                        query_location=161,
                                        type='COMPARE_EQUAL',
                                        clazz='COMPARISON',
                                        alias='',
                                        left=ParsedExpressionSubclasses(
                                            root=ColumnRefExpression(
                                                query_location=148,
                                                type='COLUMN_REF',
                                                clazz='COLUMN_REF',
                                                alias='',
                                                column_names=['grades', 'course']
                                            )
                                        ),
                                        right=ParsedExpressionSubclasses(
                                            root=ColumnRefExpression(
                                                query_location=162,
                                                type='COLUMN_REF',
                                                clazz='COLUMN_REF',
                                                alias='',
                                                column_names=['grades_parent', 'course']
                                            )
                                        )
                                    )
                                ),
                                sample=None,
                                qualify=None,
                                having=None,
                                group_sets=[],
                                group_expressions=[],
                                aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
                                from_table=TableRefSubclasses(
                                    root=BaseTableRef(
                                        query_location=122,
                                        alias='',
                                        sample=None,
                                        type='BASE_TABLE',
                                        schema_name='',
                                        table_name='grades',
                                        catalog_name='',
                                        column_name_alias=[]
                                    )
                                )
                            )
                        )
                    ),
                    subquery_type='SCALAR'
                )
            )
        )
    ),
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=31,
            alias='grades_parent',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='grades',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[ SELECT * FROM range(10) t1 UNION ALL SELECT * FROM range(5) t2; ] 1'] = '''SetOperationNode(
    query_location=None,
    type='SET_OPERATION_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    setop_type='UNION',
    left=QueryNodeSubclasses(
        root=SelectNode(
            query_location=None,
            type='SELECT_NODE',
            modifiers=[],
            cte_map=CommonTableExpressionMap(
                query_location=None,
                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
            ),
            select_list=[
                ParsedExpressionSubclasses(
                    root=StarExpression(
                        query_location=16,
                        type='STAR',
                        clazz='STAR',
                        alias='',
                        columns=False,
                        replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                        relation_name='',
                        exclude_list=[],
                        expr=None,
                        unpacked=False
                    )
                )
            ],
            where_clause=None,
            sample=None,
            qualify=None,
            having=None,
            group_sets=[],
            group_expressions=[],
            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
            from_table=TableRefSubclasses(
                root=TableFunctionRef(
                    query_location=23,
                    alias='t1',
                    sample=None,
                    type='TABLE_FUNCTION',
                    function=FunctionExpression(
                        query_location=23,
                        type='FUNCTION',
                        clazz='FUNCTION',
                        alias='',
                        schema_name='',
                        function_name='range',
                        catalog='',
                        is_operator=False,
                        children=[
                            ParsedExpressionSubclasses(
                                root=ConstantExpression(
                                    query_location=29,
                                    type='VALUE_CONSTANT',
                                    clazz='CONSTANT',
                                    alias='',
                                    value=Value(
                                        query_location=None,
                                        type=LogicalType(
                                            query_location=None,
                                            id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                            type_info=None
                                        ),
                                        value=10,
                                        is_null=False
                                    )
                                )
                            )
                        ],
                        distinct=False,
                        order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                        export_state=False,
                        filter=None
                    ),
                    column_name_alias=[]
                )
            )
        )
    ),
    right=QueryNodeSubclasses(
        root=SelectNode(
            query_location=None,
            type='SELECT_NODE',
            modifiers=[],
            cte_map=CommonTableExpressionMap(
                query_location=None,
                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
            ),
            select_list=[
                ParsedExpressionSubclasses(
                    root=StarExpression(
                        query_location=53,
                        type='STAR',
                        clazz='STAR',
                        alias='',
                        columns=False,
                        replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                        relation_name='',
                        exclude_list=[],
                        expr=None,
                        unpacked=False
                    )
                )
            ],
            where_clause=None,
            sample=None,
            qualify=None,
            having=None,
            group_sets=[],
            group_expressions=[],
            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
            from_table=TableRefSubclasses(
                root=TableFunctionRef(
                    query_location=60,
                    alias='t2',
                    sample=None,
                    type='TABLE_FUNCTION',
                    function=FunctionExpression(
                        query_location=60,
                        type='FUNCTION',
                        clazz='FUNCTION',
                        alias='',
                        schema_name='',
                        function_name='range',
                        catalog='',
                        is_operator=False,
                        children=[
                            ParsedExpressionSubclasses(
                                root=ConstantExpression(
                                    query_location=66,
                                    type='VALUE_CONSTANT',
                                    clazz='CONSTANT',
                                    alias='',
                                    value=Value(
                                        query_location=None,
                                        type=LogicalType(
                                            query_location=None,
                                            id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                            type_info=None
                                        ),
                                        value=5,
                                        is_null=False
                                    )
                                )
                            )
                        ],
                        distinct=False,
                        order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                        export_state=False,
                        filter=None
                    ),
                    column_name_alias=[]
                )
            )
        )
    ),
    setop_all=True
)
'''

snapshots['test_sql[ SELECT Plant, Date, AVG(MWh) OVER ( PARTITION BY Plant ORDER BY Date ASC RANGE BETWEEN INTERVAL 3 DAYS PRECEDING AND INTERVAL 3 DAYS FOLLOWING) AS \'MWh 7-day Moving Average\' FROM \'Generation History\' ORDER BY 1, 2 ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[
        ResultModifierSubclasses(
            root=OrderModifier(
                query_location=None,
                type='ORDER_MODIFIER',
                orders=[
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ConstantExpression(
                                query_location=272,
                                type='VALUE_CONSTANT',
                                clazz='CONSTANT',
                                alias='',
                                value=Value(
                                    query_location=None,
                                    type=LogicalType(
                                        query_location=None,
                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                        type_info=None
                                    ),
                                    value=1,
                                    is_null=False
                                )
                            )
                        )
                    ),
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ConstantExpression(
                                query_location=275,
                                type='VALUE_CONSTANT',
                                clazz='CONSTANT',
                                alias='',
                                value=Value(
                                    query_location=None,
                                    type=LogicalType(
                                        query_location=None,
                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                        type_info=None
                                    ),
                                    value=2,
                                    is_null=False
                                )
                            )
                        )
                    )
                ]
            )
        )
    ],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=16,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['Plant']
            )
        ),
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=23,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['Date']
            )
        ),
        ParsedExpressionSubclasses(
            root=WindowExpression(
                query_location=33,
                type='WINDOW_AGGREGATE',
                clazz='WINDOW',
                alias='MWh 7-day Moving Average',
                catalog='',
                schema_name='',
                function_name='avg',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=37,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['MWh']
                        )
                    )
                ],
                partitions=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=70,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['Plant']
                        )
                    )
                ],
                orders=[
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.ASCENDING: 'ASCENDING'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=93,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['Date']
                            )
                        )
                    )
                ],
                filter_expr=None,
                ignore_nulls=False,
                start=<WindowBoundary.EXPR_PRECEDING_RANGE: 'EXPR_PRECEDING_RANGE'>,
                end=<WindowBoundary.EXPR_FOLLOWING_RANGE: 'EXPR_FOLLOWING_RANGE'>,
                start_expr=ParsedExpressionSubclasses(
                    root=FunctionExpression(
                        query_location=18446744073709551615,
                        type='FUNCTION',
                        clazz='FUNCTION',
                        alias='',
                        schema_name='',
                        function_name='to_days',
                        catalog='',
                        is_operator=False,
                        children=[
                            ParsedExpressionSubclasses(
                                root=CastExpression(
                                    query_location=18446744073709551615,
                                    type='OPERATOR_CAST',
                                    clazz='CAST',
                                    alias='',
                                    child=ParsedExpressionSubclasses(
                                        root=FunctionExpression(
                                            query_location=18446744073709551615,
                                            type='FUNCTION',
                                            clazz='FUNCTION',
                                            alias='',
                                            schema_name='',
                                            function_name='trunc',
                                            catalog='',
                                            is_operator=False,
                                            children=[
                                                ParsedExpressionSubclasses(
                                                    root=CastExpression(
                                                        query_location=18446744073709551615,
                                                        type='OPERATOR_CAST',
                                                        clazz='CAST',
                                                        alias='',
                                                        child=ParsedExpressionSubclasses(
                                                            root=ConstantExpression(
                                                                query_location=18446744073709551615,
                                                                type='VALUE_CONSTANT',
                                                                clazz='CONSTANT',
                                                                alias='',
                                                                value=Value(
                                                                    query_location=None,
                                                                    type=LogicalType(
                                                                        query_location=None,
                                                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                                        type_info=None
                                                                    ),
                                                                    value=3,
                                                                    is_null=False
                                                                )
                                                            )
                                                        ),
                                                        cast_type=LogicalType(
                                                            query_location=None,
                                                            id=<LogicalTypeId.DOUBLE: 'DOUBLE'>,
                                                            type_info=None
                                                        ),
                                                        try_cast=False
                                                    )
                                                )
                                            ],
                                            distinct=False,
                                            order_bys=OrderModifier(
                                                query_location=None,
                                                type='ORDER_MODIFIER',
                                                orders=[]
                                            ),
                                            export_state=False,
                                            filter=None
                                        )
                                    ),
                                    cast_type=LogicalType(
                                        query_location=None,
                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                        type_info=None
                                    ),
                                    try_cast=False
                                )
                            )
                        ],
                        distinct=False,
                        order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                        export_state=False,
                        filter=None
                    )
                ),
                end_expr=ParsedExpressionSubclasses(
                    root=FunctionExpression(
                        query_location=18446744073709551615,
                        type='FUNCTION',
                        clazz='FUNCTION',
                        alias='',
                        schema_name='',
                        function_name='to_days',
                        catalog='',
                        is_operator=False,
                        children=[
                            ParsedExpressionSubclasses(
                                root=CastExpression(
                                    query_location=18446744073709551615,
                                    type='OPERATOR_CAST',
                                    clazz='CAST',
                                    alias='',
                                    child=ParsedExpressionSubclasses(
                                        root=FunctionExpression(
                                            query_location=18446744073709551615,
                                            type='FUNCTION',
                                            clazz='FUNCTION',
                                            alias='',
                                            schema_name='',
                                            function_name='trunc',
                                            catalog='',
                                            is_operator=False,
                                            children=[
                                                ParsedExpressionSubclasses(
                                                    root=CastExpression(
                                                        query_location=18446744073709551615,
                                                        type='OPERATOR_CAST',
                                                        clazz='CAST',
                                                        alias='',
                                                        child=ParsedExpressionSubclasses(
                                                            root=ConstantExpression(
                                                                query_location=18446744073709551615,
                                                                type='VALUE_CONSTANT',
                                                                clazz='CONSTANT',
                                                                alias='',
                                                                value=Value(
                                                                    query_location=None,
                                                                    type=LogicalType(
                                                                        query_location=None,
                                                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                                        type_info=None
                                                                    ),
                                                                    value=3,
                                                                    is_null=False
                                                                )
                                                            )
                                                        ),
                                                        cast_type=LogicalType(
                                                            query_location=None,
                                                            id=<LogicalTypeId.DOUBLE: 'DOUBLE'>,
                                                            type_info=None
                                                        ),
                                                        try_cast=False
                                                    )
                                                )
                                            ],
                                            distinct=False,
                                            order_bys=OrderModifier(
                                                query_location=None,
                                                type='ORDER_MODIFIER',
                                                orders=[]
                                            ),
                                            export_state=False,
                                            filter=None
                                        )
                                    ),
                                    cast_type=LogicalType(
                                        query_location=None,
                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                        type_info=None
                                    ),
                                    try_cast=False
                                )
                            )
                        ],
                        distinct=False,
                        order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                        export_state=False,
                        filter=None
                    )
                ),
                offset_expr=None,
                default_expr=None,
                exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                distinct=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=242,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='Generation History',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[ SELECT amount - lead(amount) OVER (ORDER BY time), amount - lag(amount) OVER (ORDER BY time), amount / SUM(amount) OVER (PARTITION BY region), FIRST(employee_name) OVER (ORDER BY salary DESC), LAST(employee_name) OVER (ORDER BY salary DESC), NTH_VALUE(employee_name, 2) OVER (ORDER BY salary DESC) FROM basic_pays ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=23,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='-',
                catalog='',
                is_operator=True,
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=16,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['amount']
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=WindowExpression(
                            query_location=25,
                            type='WINDOW_LEAD',
                            clazz='WINDOW',
                            alias='',
                            catalog='',
                            schema_name='',
                            function_name='lead',
                            children=[
                                ParsedExpressionSubclasses(
                                    root=ColumnRefExpression(
                                        query_location=30,
                                        type='COLUMN_REF',
                                        clazz='COLUMN_REF',
                                        alias='',
                                        column_names=['amount']
                                    )
                                )
                            ],
                            partitions=[],
                            orders=[
                                OrderByNode(
                                    query_location=None,
                                    type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                                    null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                                    expression=ParsedExpressionSubclasses(
                                        root=ColumnRefExpression(
                                            query_location=53,
                                            type='COLUMN_REF',
                                            clazz='COLUMN_REF',
                                            alias='',
                                            column_names=['time']
                                        )
                                    )
                                )
                            ],
                            filter_expr=None,
                            ignore_nulls=False,
                            start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                            end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                            start_expr=None,
                            end_expr=None,
                            offset_expr=None,
                            default_expr=None,
                            exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                            distinct=False
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        ),
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=82,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='-',
                catalog='',
                is_operator=True,
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=75,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['amount']
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=WindowExpression(
                            query_location=84,
                            type='WINDOW_LAG',
                            clazz='WINDOW',
                            alias='',
                            catalog='',
                            schema_name='',
                            function_name='lag',
                            children=[
                                ParsedExpressionSubclasses(
                                    root=ColumnRefExpression(
                                        query_location=88,
                                        type='COLUMN_REF',
                                        clazz='COLUMN_REF',
                                        alias='',
                                        column_names=['amount']
                                    )
                                )
                            ],
                            partitions=[],
                            orders=[
                                OrderByNode(
                                    query_location=None,
                                    type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                                    null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                                    expression=ParsedExpressionSubclasses(
                                        root=ColumnRefExpression(
                                            query_location=111,
                                            type='COLUMN_REF',
                                            clazz='COLUMN_REF',
                                            alias='',
                                            column_names=['time']
                                        )
                                    )
                                )
                            ],
                            filter_expr=None,
                            ignore_nulls=False,
                            start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                            end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                            start_expr=None,
                            end_expr=None,
                            offset_expr=None,
                            default_expr=None,
                            exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                            distinct=False
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        ),
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=140,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='/',
                catalog='',
                is_operator=True,
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=133,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['amount']
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=WindowExpression(
                            query_location=142,
                            type='WINDOW_AGGREGATE',
                            clazz='WINDOW',
                            alias='',
                            catalog='',
                            schema_name='',
                            function_name='sum',
                            children=[
                                ParsedExpressionSubclasses(
                                    root=ColumnRefExpression(
                                        query_location=146,
                                        type='COLUMN_REF',
                                        clazz='COLUMN_REF',
                                        alias='',
                                        column_names=['amount']
                                    )
                                )
                            ],
                            partitions=[
                                ParsedExpressionSubclasses(
                                    root=ColumnRefExpression(
                                        query_location=173,
                                        type='COLUMN_REF',
                                        clazz='COLUMN_REF',
                                        alias='',
                                        column_names=['region']
                                    )
                                )
                            ],
                            orders=[],
                            filter_expr=None,
                            ignore_nulls=False,
                            start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                            end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                            start_expr=None,
                            end_expr=None,
                            offset_expr=None,
                            default_expr=None,
                            exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                            distinct=False
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        ),
        ParsedExpressionSubclasses(
            root=WindowExpression(
                query_location=197,
                type='WINDOW_FIRST_VALUE',
                clazz='WINDOW',
                alias='',
                catalog='',
                schema_name='',
                function_name='first',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=203,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['employee_name']
                        )
                    )
                ],
                partitions=[],
                orders=[
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.DESCENDING: 'DESCENDING'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=233,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['salary']
                            )
                        )
                    )
                ],
                filter_expr=None,
                ignore_nulls=False,
                start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                start_expr=None,
                end_expr=None,
                offset_expr=None,
                default_expr=None,
                exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                distinct=False
            )
        ),
        ParsedExpressionSubclasses(
            root=WindowExpression(
                query_location=262,
                type='WINDOW_LAST_VALUE',
                clazz='WINDOW',
                alias='',
                catalog='',
                schema_name='',
                function_name='last',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=267,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['employee_name']
                        )
                    )
                ],
                partitions=[],
                orders=[
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.DESCENDING: 'DESCENDING'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=298,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['salary']
                            )
                        )
                    )
                ],
                filter_expr=None,
                ignore_nulls=False,
                start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                start_expr=None,
                end_expr=None,
                offset_expr=None,
                default_expr=None,
                exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                distinct=False
            )
        ),
        ParsedExpressionSubclasses(
            root=WindowExpression(
                query_location=327,
                type='WINDOW_NTH_VALUE',
                clazz='WINDOW',
                alias='',
                catalog='',
                schema_name='',
                function_name='nth_value',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=337,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['employee_name']
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=352,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                ),
                                value=2,
                                is_null=False
                            )
                        )
                    )
                ],
                partitions=[],
                orders=[
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.DESCENDING: 'DESCENDING'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=370,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['salary']
                            )
                        )
                    )
                ],
                filter_expr=None,
                ignore_nulls=False,
                start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                start_expr=None,
                end_expr=None,
                offset_expr=None,
                default_expr=None,
                exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                distinct=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=396,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='basic_pays',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[ SELECT city, COUNT(*) FROM addresses GROUP BY city HAVING COUNT(*) >= 50; ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=16,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['city']
            )
        ),
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=22,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='count_star',
                catalog='',
                is_operator=False,
                children=[],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=ParsedExpressionSubclasses(
        root=ComparisonExpression(
            query_location=100,
            type='COMPARE_GREATERTHANOREQUALTO',
            clazz='COMPARISON',
            alias='',
            left=ParsedExpressionSubclasses(
                root=FunctionExpression(
                    query_location=91,
                    type='FUNCTION',
                    clazz='FUNCTION',
                    alias='',
                    schema_name='',
                    function_name='count_star',
                    catalog='',
                    is_operator=False,
                    children=[],
                    distinct=False,
                    order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                    export_state=False,
                    filter=None
                )
            ),
            right=ParsedExpressionSubclasses(
                root=ConstantExpression(
                    query_location=103,
                    type='VALUE_CONSTANT',
                    clazz='CONSTANT',
                    alias='',
                    value=Value(
                        query_location=None,
                        type=LogicalType(query_location=None, id=<LogicalTypeId.INTEGER: 'INTEGER'>, type_info=None),
                        value=50,
                        is_null=False
                    )
                )
            )
        )
    ),
    group_sets=[{0}],
    group_expressions=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=71,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['city']
            )
        )
    ],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=44,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='addresses',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[ WITH RECURSIVE per_investor_amount AS ( SELECT 0 AS investors_number, 0.00 AS investment_amount, 0.00 AS individual_amount UNION SELECT investors_number + 1, i.investment_amount, i.investment_amount / (investors_number + 1) FROM investment i, per_investor_amount pia WHERE investors_number << 3 ) SELECT * FROM per_investor_amount ORDER BY investment_amount, investors_number; ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[
        ResultModifierSubclasses(
            root=OrderModifier(
                query_location=None,
                type='ORDER_MODIFIER',
                orders=[
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=526,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['investment_amount']
                            )
                        )
                    ),
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=545,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['investors_number']
                            )
                        )
                    )
                ]
            )
        )
    ],
    cte_map=CommonTableExpressionMap(
        query_location=None,
        map=OrderedDict[str, CommonTableExpressionInfo](
            root=[
                Pair[str, CommonTableExpressionInfo](
                    key='per_investor_amount',
                    value=CommonTableExpressionInfo(
                        query_location=None,
                        aliases=[],
                        query=SelectStatement(
                            query_location=None,
                            node=QueryNodeSubclasses(
                                root=RecursiveCTENode(
                                    query_location=None,
                                    type='RECURSIVE_CTE_NODE',
                                    modifiers=[],
                                    cte_map=CommonTableExpressionMap(
                                        query_location=None,
                                        map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                                    ),
                                    cte_name='per_investor_amount',
                                    union_all=False,
                                    left=QueryNodeSubclasses(
                                        root=SelectNode(
                                            query_location=None,
                                            type='SELECT_NODE',
                                            modifiers=[],
                                            cte_map=CommonTableExpressionMap(
                                                query_location=None,
                                                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                                            ),
                                            select_list=[
                                                ParsedExpressionSubclasses(
                                                    root=ConstantExpression(
                                                        query_location=69,
                                                        type='VALUE_CONSTANT',
                                                        clazz='CONSTANT',
                                                        alias='investors_number',
                                                        value=Value(
                                                            query_location=None,
                                                            type=LogicalType(
                                                                query_location=None,
                                                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                                type_info=None
                                                            ),
                                                            value=0,
                                                            is_null=False
                                                        )
                                                    )
                                                ),
                                                ParsedExpressionSubclasses(
                                                    root=ConstantExpression(
                                                        query_location=112,
                                                        type='VALUE_CONSTANT',
                                                        clazz='CONSTANT',
                                                        alias='investment_amount',
                                                        value=Value(
                                                            query_location=None,
                                                            type=LogicalType(
                                                                query_location=None,
                                                                id=<LogicalTypeId.DECIMAL: 'DECIMAL'>,
                                                                type_info=DecimalTypeInfo(
                                                                    query_location=None,
                                                                    type='DECIMAL_TYPE_INFO',
                                                                    alias='',
                                                                    catalog_entry=None,
                                                                    modifiers=[],
                                                                    width=3,
                                                                    scale=2
                                                                )
                                                            ),
                                                            value=0,
                                                            is_null=False
                                                        )
                                                    )
                                                ),
                                                ParsedExpressionSubclasses(
                                                    root=ConstantExpression(
                                                        query_location=159,
                                                        type='VALUE_CONSTANT',
                                                        clazz='CONSTANT',
                                                        alias='individual_amount',
                                                        value=Value(
                                                            query_location=None,
                                                            type=LogicalType(
                                                                query_location=None,
                                                                id=<LogicalTypeId.DECIMAL: 'DECIMAL'>,
                                                                type_info=DecimalTypeInfo(
                                                                    query_location=None,
                                                                    type='DECIMAL_TYPE_INFO',
                                                                    alias='',
                                                                    catalog_entry=None,
                                                                    modifiers=[],
                                                                    width=3,
                                                                    scale=2
                                                                )
                                                            ),
                                                            value=0,
                                                            is_null=False
                                                        )
                                                    )
                                                )
                                            ],
                                            where_clause=None,
                                            sample=None,
                                            qualify=None,
                                            having=None,
                                            group_sets=[],
                                            group_expressions=[],
                                            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 
'STANDARD_HANDLING'>,
                                            from_table=TableRefSubclasses(
                                                root=EmptyTableRef(
                                                    query_location=18446744073709551615,
                                                    alias='',
                                                    sample=None,
                                                    type='EMPTY'
                                                )
                                            )
                                        )
                                    ),
                                    right=QueryNodeSubclasses(
                                        root=SelectNode(
                                            query_location=None,
                                            type='SELECT_NODE',
                                            modifiers=[],
                                            cte_map=CommonTableExpressionMap(
                                                query_location=None,
                                                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                                            ),
                                            select_list=[
                                                ParsedExpressionSubclasses(
                                                    root=FunctionExpression(
                                                        query_location=241,
                                                        type='FUNCTION',
                                                        clazz='FUNCTION',
                                                        alias='',
                                                        schema_name='',
                                                        function_name='+',
                                                        catalog='',
                                                        is_operator=True,
                                                        children=[
                                                            ParsedExpressionSubclasses(
                                                                root=ColumnRefExpression(
                                                                    query_location=224,
                                                                    type='COLUMN_REF',
                                                                    clazz='COLUMN_REF',
                                                                    alias='',
                                                                    column_names=['investors_number']
                                                                )
                                                            ),
                                                            ParsedExpressionSubclasses(
                                                                root=ConstantExpression(
                                                                    query_location=243,
                                                                    type='VALUE_CONSTANT',
                                                                    clazz='CONSTANT',
                                                                    alias='',
                                                                    value=Value(
                                                                        query_location=None,
                                                                        type=LogicalType(
                                                                            query_location=None,
                                                                            id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                                            type_info=None
                                                                        ),
                                                                        value=1,
                                                                        is_null=False
                                                                    )
                                                                )
                                                            )
                                                        ],
                                                        distinct=False,
                                                        order_bys=OrderModifier(
                                                            query_location=None,
                                                            type='ORDER_MODIFIER',
                                                            orders=[]
                                                        ),
                                                        export_state=False,
                                                        filter=None
                                                    )
                                                ),
                                                ParsedExpressionSubclasses(
                                                    root=ColumnRefExpression(
                                                        query_location=266,
                                                        type='COLUMN_REF',
                                                        clazz='COLUMN_REF',
                                                        alias='',
                                                        column_names=['i', 'investment_amount']
                                                    )
                                                ),
                                                ParsedExpressionSubclasses(
                                                    root=FunctionExpression(
                                                        query_location=327,
                                                        type='FUNCTION',
                                                        clazz='FUNCTION',
                                                        alias='',
                                                        schema_name='',
                                                        function_name='/',
                                                        catalog='',
                                                        is_operator=True,
                                                        children=[
                                                            ParsedExpressionSubclasses(
                                                                root=ColumnRefExpression(
                                                                    query_location=307,
                                                                    type='COLUMN_REF',
                                                                    clazz='COLUMN_REF',
                                                                    alias='',
                                                                    column_names=['i', 'investment_amount']
                                                                )
                                                            ),
                                                            ParsedExpressionSubclasses(
                                                                root=FunctionExpression(
                                                                    query_location=347,
                                                                    type='FUNCTION',
                                                                    clazz='FUNCTION',
                                                                    alias='',
                                                                    schema_name='',
                                                                    function_name='+',
                                                                    catalog='',
                                                                    is_operator=True,
                                                                    children=[
                                                                        ParsedExpressionSubclasses(
                                                                            root=ColumnRefExpression(
                                                                                query_location=330,
                                                                                type='COLUMN_REF',
                                                                                clazz='COLUMN_REF',
                                                                                alias='',
                                                                                column_names=['investors_number']
                                                                            )
                                                                        ),
                                                                        ParsedExpressionSubclasses(
                                                                            root=ConstantExpression(
                                                                                query_location=349,
                                                                                type='VALUE_CONSTANT',
                                                                                clazz='CONSTANT',
                                                                                alias='',
                                                                                value=Value(
                                                                                    query_location=None,
                                                                                    type=LogicalType(
                                                                                        query_location=None,
                                                                                        id=<LogicalTypeId.INTEGER: 
'INTEGER'>,
                                                                                        type_info=None
                                                                                    ),
                                                                                    value=1,
                                                                                    is_null=False
                                                                                )
                                                                            )
                                                                        )
                                                                    ],
                                                                    distinct=False,
                                                                    order_bys=OrderModifier(
                                                                        query_location=None,
                                                                        type='ORDER_MODIFIER',
                                                                        orders=[]
                                                                    ),
                                                                    export_state=False,
                                                                    filter=None
                                                                )
                                                            )
                                                        ],
                                                        distinct=False,
                                                        order_bys=OrderModifier(
                                                            query_location=None,
                                                            type='ORDER_MODIFIER',
                                                            orders=[]
                                                        ),
                                                        export_state=False,
                                                        filter=None
                                                    )
                                                )
                                            ],
                                            where_clause=ParsedExpressionSubclasses(
                                                root=FunctionExpression(
                                                    query_location=442,
                                                    type='FUNCTION',
                                                    clazz='FUNCTION',
                                                    alias='',
                                                    schema_name='',
                                                    function_name='<<',
                                                    catalog='',
                                                    is_operator=True,
                                                    children=[
                                                        ParsedExpressionSubclasses(
                                                            root=ColumnRefExpression(
                                                                query_location=425,
                                                                type='COLUMN_REF',
                                                                clazz='COLUMN_REF',
                                                                alias='',
                                                                column_names=['investors_number']
                                                            )
                                                        ),
                                                        ParsedExpressionSubclasses(
                                                            root=ConstantExpression(
                                                                query_location=445,
                                                                type='VALUE_CONSTANT',
                                                                clazz='CONSTANT',
                                                                alias='',
                                                                value=Value(
                                                                    query_location=None,
                                                                    type=LogicalType(
                                                                        query_location=None,
                                                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                                        type_info=None
                                                                    ),
                                                                    value=3,
                                                                    is_null=False
                                                                )
                                                            )
                                                        )
                                                    ],
                                                    distinct=False,
                                                    order_bys=OrderModifier(
                                                        query_location=None,
                                                        type='ORDER_MODIFIER',
                                                        orders=[]
                                                    ),
                                                    export_state=False,
                                                    filter=None
                                                )
                                            ),
                                            sample=None,
                                            qualify=None,
                                            having=None,
                                            group_sets=[],
                                            group_expressions=[],
                                            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 
'STANDARD_HANDLING'>,
                                            from_table=TableRefSubclasses(
                                                root=JoinRef(
                                                    query_location=18446744073709551615,
                                                    alias='',
                                                    sample=None,
                                                    type='JOIN',
                                                    right=TableRefSubclasses(
                                                        root=BaseTableRef(
                                                            query_location=383,
                                                            alias='pia',
                                                            sample=None,
                                                            type='BASE_TABLE',
                                                            schema_name='',
                                                            table_name='per_investor_amount',
                                                            catalog_name='',
                                                            column_name_alias=[]
                                                        )
                                                    ),
                                                    left=TableRefSubclasses(
                                                        root=BaseTableRef(
                                                            query_location=369,
                                                            alias='i',
                                                            sample=None,
                                                            type='BASE_TABLE',
                                                            schema_name='',
                                                            table_name='investment',
                                                            catalog_name='',
                                                            column_name_alias=[]
                                                        )
                                                    ),
                                                    join_type='INNER',
                                                    ref_type='CROSS',
                                                    condition=None,
                                                    using_columns=[],
                                                    delim_flipped=False,
                                                    duplicate_eliminated_columns=[]
                                                )
                                            )
                                        )
                                    ),
                                    aliases=[]
                                )
                            )
                        ),
                        materialized='CTE_MATERIALIZE_DEFAULT'
                    )
                )
            ]
        )
    ),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=473,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                relation_name='',
                exclude_list=[],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=488,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='per_investor_amount',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[ WITH RECURSIVE tag_hierarchy(id, source, path) AS ( SELECT id, name, [name] AS path FROM tag WHERE subclassof IS NULL UNION ALL SELECT tag.id, tag.name, list_prepend(tag.name, tag_hierarchy.path) FROM tag, tag_hierarchy WHERE tag.subclassof = tag_hierarchy.id ) SELECT path FROM tag_hierarchy WHERE source = \'Oasis\'; ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(
        query_location=None,
        map=OrderedDict[str, CommonTableExpressionInfo](
            root=[
                Pair[str, CommonTableExpressionInfo](
                    key='tag_hierarchy',
                    value=CommonTableExpressionInfo(
                        query_location=None,
                        aliases=['id', 'source', 'path'],
                        query=SelectStatement(
                            query_location=None,
                            node=QueryNodeSubclasses(
                                root=RecursiveCTENode(
                                    query_location=None,
                                    type='RECURSIVE_CTE_NODE',
                                    modifiers=[],
                                    cte_map=CommonTableExpressionMap(
                                        query_location=None,
                                        map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                                    ),
                                    cte_name='tag_hierarchy',
                                    union_all=True,
                                    left=QueryNodeSubclasses(
                                        root=SelectNode(
                                            query_location=None,
                                            type='SELECT_NODE',
                                            modifiers=[],
                                            cte_map=CommonTableExpressionMap(
                                                query_location=None,
                                                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                                            ),
                                            select_list=[
                                                ParsedExpressionSubclasses(
                                                    root=ColumnRefExpression(
                                                        query_location=70,
                                                        type='COLUMN_REF',
                                                        clazz='COLUMN_REF',
                                                        alias='',
                                                        column_names=['id']
                                                    )
                                                ),
                                                ParsedExpressionSubclasses(
                                                    root=ColumnRefExpression(
                                                        query_location=74,
                                                        type='COLUMN_REF',
                                                        clazz='COLUMN_REF',
                                                        alias='',
                                                        column_names=['name']
                                                    )
                                                ),
                                                ParsedExpressionSubclasses(
                                                    root=FunctionExpression(
                                                        query_location=81,
                                                        type='FUNCTION',
                                                        clazz='FUNCTION',
                                                        alias='path',
                                                        schema_name='main',
                                                        function_name='list_value',
                                                        catalog='',
                                                        is_operator=False,
                                                        children=[
                                                            ParsedExpressionSubclasses(
                                                                root=ColumnRefExpression(
                                                                    query_location=81,
                                                                    type='COLUMN_REF',
                                                                    clazz='COLUMN_REF',
                                                                    alias='',
                                                                    column_names=['name']
                                                                )
                                                            )
                                                        ],
                                                        distinct=False,
                                                        order_bys=OrderModifier(
                                                            query_location=None,
                                                            type='ORDER_MODIFIER',
                                                            orders=[]
                                                        ),
                                                        export_state=False,
                                                        filter=None
                                                    )
                                                )
                                            ],
                                            where_clause=ParsedExpressionSubclasses(
                                                root=OperatorExpression(
                                                    query_location=125,
                                                    type='OPERATOR_IS_NULL',
                                                    clazz='OPERATOR',
                                                    alias='',
                                                    children=[
                                                        ParsedExpressionSubclasses(
                                                            root=ColumnRefExpression(
                                                                query_location=114,
                                                                type='COLUMN_REF',
                                                                clazz='COLUMN_REF',
                                                                alias='',
                                                                column_names=['subclassof']
                                                            )
                                                        )
                                                    ]
                                                )
                                            ),
                                            sample=None,
                                            qualify=None,
                                            having=None,
                                            group_sets=[],
                                            group_expressions=[],
                                            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 
'STANDARD_HANDLING'>,
                                            from_table=TableRefSubclasses(
                                                root=BaseTableRef(
                                                    query_location=102,
                                                    alias='',
                                                    sample=None,
                                                    type='BASE_TABLE',
                                                    schema_name='',
                                                    table_name='tag',
                                                    catalog_name='',
                                                    column_name_alias=[]
                                                )
                                            )
                                        )
                                    ),
                                    right=QueryNodeSubclasses(
                                        root=SelectNode(
                                            query_location=None,
                                            type='SELECT_NODE',
                                            modifiers=[],
                                            cte_map=CommonTableExpressionMap(
                                                query_location=None,
                                                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                                            ),
                                            select_list=[
                                                ParsedExpressionSubclasses(
                                                    root=ColumnRefExpression(
                                                        query_location=152,
                                                        type='COLUMN_REF',
                                                        clazz='COLUMN_REF',
                                                        alias='',
                                                        column_names=['tag', 'id']
                                                    )
                                                ),
                                                ParsedExpressionSubclasses(
                                                    root=ColumnRefExpression(
                                                        query_location=160,
                                                        type='COLUMN_REF',
                                                        clazz='COLUMN_REF',
                                                        alias='',
                                                        column_names=['tag', 'name']
                                                    )
                                                ),
                                                ParsedExpressionSubclasses(
                                                    root=FunctionExpression(
                                                        query_location=170,
                                                        type='FUNCTION',
                                                        clazz='FUNCTION',
                                                        alias='',
                                                        schema_name='',
                                                        function_name='list_prepend',
                                                        catalog='',
                                                        is_operator=False,
                                                        children=[
                                                            ParsedExpressionSubclasses(
                                                                root=ColumnRefExpression(
                                                                    query_location=183,
                                                                    type='COLUMN_REF',
                                                                    clazz='COLUMN_REF',
                                                                    alias='',
                                                                    column_names=['tag', 'name']
                                                                )
                                                            ),
                                                            ParsedExpressionSubclasses(
                                                                root=ColumnRefExpression(
                                                                    query_location=193,
                                                                    type='COLUMN_REF',
                                                                    clazz='COLUMN_REF',
                                                                    alias='',
                                                                    column_names=['tag_hierarchy', 'path']
                                                                )
                                                            )
                                                        ],
                                                        distinct=False,
                                                        order_bys=OrderModifier(
                                                            query_location=None,
                                                            type='ORDER_MODIFIER',
                                                            orders=[]
                                                        ),
                                                        export_state=False,
                                                        filter=None
                                                    )
                                                )
                                            ],
                                            where_clause=ParsedExpressionSubclasses(
                                                root=ComparisonExpression(
                                                    query_location=262,
                                                    type='COMPARE_EQUAL',
                                                    clazz='COMPARISON',
                                                    alias='',
                                                    left=ParsedExpressionSubclasses(
                                                        root=ColumnRefExpression(
                                                            query_location=247,
                                                            type='COLUMN_REF',
                                                            clazz='COLUMN_REF',
                                                            alias='',
                                                            column_names=['tag', 'subclassof']
                                                        )
                                                    ),
                                                    right=ParsedExpressionSubclasses(
                                                        root=ColumnRefExpression(
                                                            query_location=264,
                                                            type='COLUMN_REF',
                                                            clazz='COLUMN_REF',
                                                            alias='',
                                                            column_names=['tag_hierarchy', 'id']
                                                        )
                                                    )
                                                )
                                            ),
                                            sample=None,
                                            qualify=None,
                                            having=None,
                                            group_sets=[],
                                            group_expressions=[],
                                            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 
'STANDARD_HANDLING'>,
                                            from_table=TableRefSubclasses(
                                                root=JoinRef(
                                                    query_location=18446744073709551615,
                                                    alias='',
                                                    sample=None,
                                                    type='JOIN',
                                                    right=TableRefSubclasses(
                                                        root=BaseTableRef(
                                                            query_location=225,
                                                            alias='',
                                                            sample=None,
                                                            type='BASE_TABLE',
                                                            schema_name='',
                                                            table_name='tag_hierarchy',
                                                            catalog_name='',
                                                            column_name_alias=[]
                                                        )
                                                    ),
                                                    left=TableRefSubclasses(
                                                        root=BaseTableRef(
                                                            query_location=220,
                                                            alias='',
                                                            sample=None,
                                                            type='BASE_TABLE',
                                                            schema_name='',
                                                            table_name='tag',
                                                            catalog_name='',
                                                            column_name_alias=[]
                                                        )
                                                    ),
                                                    join_type='INNER',
                                                    ref_type='CROSS',
                                                    condition=None,
                                                    using_columns=[],
                                                    delim_flipped=False,
                                                    duplicate_eliminated_columns=[]
                                                )
                                            )
                                        )
                                    ),
                                    aliases=['id', 'source', 'path']
                                )
                            )
                        ),
                        materialized='CTE_MATERIALIZE_DEFAULT'
                    )
                )
            ]
        )
    ),
    select_list=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=290,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['path']
            )
        )
    ],
    where_clause=ParsedExpressionSubclasses(
        root=ComparisonExpression(
            query_location=327,
            type='COMPARE_EQUAL',
            clazz='COMPARISON',
            alias='',
            left=ParsedExpressionSubclasses(
                root=ColumnRefExpression(
                    query_location=320,
                    type='COLUMN_REF',
                    clazz='COLUMN_REF',
                    alias='',
                    column_names=['source']
                )
            ),
            right=ParsedExpressionSubclasses(
                root=ConstantExpression(
                    query_location=329,
                    type='VALUE_CONSTANT',
                    clazz='CONSTANT',
                    alias='',
                    value=Value(
                        query_location=None,
                        type=LogicalType(query_location=None, id=<LogicalTypeId.VARCHAR: 'VARCHAR'>, type_info=None),
                        value='Oasis',
                        is_null=False
                    )
                )
            )
        )
    ),
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=300,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='tag_hierarchy',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[ WITH ranked_functions as ( SELECT schema_name, function_name, row_number() over (partition by schema_name order by function_name) as function_rank FROM duckdb_functions() ) SELECT * FROM ranked_functions WHERE function_rank < 3; ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(
        query_location=None,
        map=OrderedDict[str, CommonTableExpressionInfo](
            root=[
                Pair[str, CommonTableExpressionInfo](
                    key='ranked_functions',
                    value=CommonTableExpressionInfo(
                        query_location=None,
                        aliases=[],
                        query=SelectStatement(
                            query_location=None,
                            node=QueryNodeSubclasses(
                                root=SelectNode(
                                    query_location=None,
                                    type='SELECT_NODE',
                                    modifiers=[],
                                    cte_map=CommonTableExpressionMap(
                                        query_location=None,
                                        map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                                    ),
                                    select_list=[
                                        ParsedExpressionSubclasses(
                                            root=ColumnRefExpression(
                                                query_location=71,
                                                type='COLUMN_REF',
                                                clazz='COLUMN_REF',
                                                alias='',
                                                column_names=['schema_name']
                                            )
                                        ),
                                        ParsedExpressionSubclasses(
                                            root=ColumnRefExpression(
                                                query_location=100,
                                                type='COLUMN_REF',
                                                clazz='COLUMN_REF',
                                                alias='',
                                                column_names=['function_name']
                                            )
                                        ),
                                        ParsedExpressionSubclasses(
                                            root=WindowExpression(
                                                query_location=131,
                                                type='WINDOW_ROW_NUMBER',
                                                clazz='WINDOW',
                                                alias='function_rank',
                                                catalog='',
                                                schema_name='',
                                                function_name='row_number',
                                                children=[],
                                                partitions=[
                                                    ParsedExpressionSubclasses(
                                                        root=ColumnRefExpression(
                                                            query_location=163,
                                                            type='COLUMN_REF',
                                                            clazz='COLUMN_REF',
                                                            alias='',
                                                            column_names=['schema_name']
                                                        )
                                                    )
                                                ],
                                                orders=[
                                                    OrderByNode(
                                                        query_location=None,
                                                        type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                                                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                                                        expression=ParsedExpressionSubclasses(
                                                            root=ColumnRefExpression(
                                                                query_location=184,
                                                                type='COLUMN_REF',
                                                                clazz='COLUMN_REF',
                                                                alias='',
                                                                column_names=['function_name']
                                                            )
                                                        )
                                                    )
                                                ],
                                                filter_expr=None,
                                                ignore_nulls=False,
                                                start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                                                end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                                                start_expr=None,
                                                end_expr=None,
                                                offset_expr=None,
                                                default_expr=None,
                                                exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                                                distinct=False
                                            )
                                        )
                                    ],
                                    where_clause=None,
                                    sample=None,
                                    qualify=None,
                                    having=None,
                                    group_sets=[],
                                    group_expressions=[],
                                    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
                                    from_table=TableRefSubclasses(
                                        root=TableFunctionRef(
                                            query_location=233,
                                            alias='',
                                            sample=None,
                                            type='TABLE_FUNCTION',
                                            function=FunctionExpression(
                                                query_location=233,
                                                type='FUNCTION',
                                                clazz='FUNCTION',
                                                alias='',
                                                schema_name='',
                                                function_name='duckdb_functions',
                                                catalog='',
                                                is_operator=False,
                                                children=[],
                                                distinct=False,
                                                order_bys=OrderModifier(
                                                    query_location=None,
                                                    type='ORDER_MODIFIER',
                                                    orders=[]
                                                ),
                                                export_state=False,
                                                filter=None
                                            ),
                                            column_name_alias=[]
                                        )
                                    )
                                )
                            )
                        ),
                        materialized='CTE_MATERIALIZE_DEFAULT'
                    )
                )
            ]
        )
    ),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=289,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                relation_name='',
                exclude_list=[],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=ParsedExpressionSubclasses(
        root=ComparisonExpression(
            query_location=361,
            type='COMPARE_LESSTHAN',
            clazz='COMPARISON',
            alias='',
            left=ParsedExpressionSubclasses(
                root=ColumnRefExpression(
                    query_location=347,
                    type='COLUMN_REF',
                    clazz='COLUMN_REF',
                    alias='',
                    column_names=['function_rank']
                )
            ),
            right=ParsedExpressionSubclasses(
                root=ConstantExpression(
                    query_location=363,
                    type='VALUE_CONSTANT',
                    clazz='CONSTANT',
                    alias='',
                    value=Value(
                        query_location=None,
                        type=LogicalType(query_location=None, id=<LogicalTypeId.INTEGER: 'INTEGER'>, type_info=None),
                        value=3,
                        is_null=False
                    )
                )
            )
        )
    ),
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=304,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='ranked_functions',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[ select (select 1) as one ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=SubqueryExpression(
                query_location=16,
                type='SUBQUERY',
                clazz='SUBQUERY',
                alias='one',
                child=None,
                comparison_type='INVALID',
                subquery=SelectStatement(
                    query_location=None,
                    node=QueryNodeSubclasses(
                        root=SelectNode(
                            query_location=None,
                            type='SELECT_NODE',
                            modifiers=[],
                            cte_map=CommonTableExpressionMap(
                                query_location=None,
                                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                            ),
                            select_list=[
                                ParsedExpressionSubclasses(
                                    root=ConstantExpression(
                                        query_location=24,
                                        type='VALUE_CONSTANT',
                                        clazz='CONSTANT',
                                        alias='',
                                        value=Value(
                                            query_location=None,
                                            type=LogicalType(
                                                query_location=None,
                                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                type_info=None
                                            ),
                                            value=1,
                                            is_null=False
                                        )
                                    )
                                )
                            ],
                            where_clause=None,
                            sample=None,
                            qualify=None,
                            having=None,
                            group_sets=[],
                            group_expressions=[],
                            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
                            from_table=TableRefSubclasses(
                                root=EmptyTableRef(
                                    query_location=18446744073709551615,
                                    alias='',
                                    sample=None,
                                    type='EMPTY'
                                )
                            )
                        )
                    )
                ),
                subquery_type='SCALAR'
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[ select thing[0], thing[\'hello\'], thing[1:3], struct_pack(hello := \'world\').hello, ] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=18446744073709551615,
                type='ARRAY_EXTRACT',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=28,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['thing']
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=34,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                ),
                                value=0,
                                is_null=False
                            )
                        )
                    )
                ]
            )
        ),
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=18446744073709551615,
                type='ARRAY_EXTRACT',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=50,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['thing']
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=56,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                    type_info=None
                                ),
                                value='hello',
                                is_null=False
                            )
                        )
                    )
                ]
            )
        ),
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=18446744073709551615,
                type='ARRAY_SLICE',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=78,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['thing']
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=84,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                ),
                                value=1,
                                is_null=False
                            )
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=86,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                ),
                                value=3,
                                is_null=False
                            )
                        )
                    )
                ]
            )
        ),
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=18446744073709551615,
                type='STRUCT_EXTRACT',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=FunctionExpression(
                            query_location=102,
                            type='FUNCTION',
                            clazz='FUNCTION',
                            alias='',
                            schema_name='',
                            function_name='struct_pack',
                            catalog='',
                            is_operator=False,
                            children=[
                                ParsedExpressionSubclasses(
                                    root=ConstantExpression(
                                        query_location=123,
                                        type='VALUE_CONSTANT',
                                        clazz='CONSTANT',
                                        alias='hello',
                                        value=Value(
                                            query_location=None,
                                            type=LogicalType(
                                                query_location=None,
                                                id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                                type_info=None
                                            ),
                                            value='world',
                                            is_null=False
                                        )
                                    )
                                )
                            ],
                            distinct=False,
                            order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                            export_state=False,
                            filter=None
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=18446744073709551615,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                    type_info=None
                                ),
                                value='hello',
                                is_null=False
                            )
                        )
                    )
                ]
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT #1, #2 FROM tbl] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=PositionalReferenceExpression(
                query_location=7,
                type='POSITIONAL_REFERENCE',
                clazz='POSITIONAL_REFERENCE',
                alias='',
                index=1
            )
        ),
        ParsedExpressionSubclasses(
            root=PositionalReferenceExpression(
                query_location=11,
                type='POSITIONAL_REFERENCE',
                clazz='POSITIONAL_REFERENCE',
                alias='',
                index=2
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=19,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='tbl',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[SELECT $hello FROM tbl] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ParameterExpression(
                query_location=18446744073709551615,
                type='VALUE_PARAMETER',
                clazz='PARAMETER',
                alias='',
                identifier='hello'
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=19,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='tbl',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[SELECT \'101010\'::BIT] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=15,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                type_info=None
                            ),
                            value='101010',
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(query_location=None, id=<LogicalTypeId.BIT: 'BIT'>, type_info=None),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT \'Math\' IN (\'CS\', \'Math\'), X NOT IN (\'CS\', \'Math\')] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=14,
                type='COMPARE_IN',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=7,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                    type_info=None
                                ),
                                value='Math',
                                is_null=False
                            )
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=18,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                    type_info=None
                                ),
                                value='CS',
                                is_null=False
                            )
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=24,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                    type_info=None
                                ),
                                value='Math',
                                is_null=False
                            )
                        )
                    )
                ]
            )
        ),
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=35,
                type='COMPARE_NOT_IN',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=33,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['X']
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=43,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                    type_info=None
                                ),
                                value='CS',
                                is_null=False
                            )
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=49,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                    type_info=None
                                ),
                                value='Math',
                                is_null=False
                            )
                        )
                    )
                ]
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT \'Math\' IN (SELECT course FROM grades);] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=SubqueryExpression(
                query_location=14,
                type='SUBQUERY',
                clazz='SUBQUERY',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                type_info=None
                            ),
                            value='Math',
                            is_null=False
                        )
                    )
                ),
                comparison_type='COMPARE_EQUAL',
                subquery=SelectStatement(
                    query_location=None,
                    node=QueryNodeSubclasses(
                        root=SelectNode(
                            query_location=None,
                            type='SELECT_NODE',
                            modifiers=[],
                            cte_map=CommonTableExpressionMap(
                                query_location=None,
                                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                            ),
                            select_list=[
                                ParsedExpressionSubclasses(
                                    root=ColumnRefExpression(
                                        query_location=25,
                                        type='COLUMN_REF',
                                        clazz='COLUMN_REF',
                                        alias='',
                                        column_names=['course']
                                    )
                                )
                            ],
                            where_clause=None,
                            sample=None,
                            qualify=None,
                            having=None,
                            group_sets=[],
                            group_expressions=[],
                            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
                            from_table=TableRefSubclasses(
                                root=BaseTableRef(
                                    query_location=37,
                                    alias='',
                                    sample=None,
                                    type='BASE_TABLE',
                                    schema_name='',
                                    table_name='grades',
                                    catalog_name='',
                                    column_name_alias=[]
                                )
                            )
                        )
                    )
                ),
                subquery_type='ANY'
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT \'hello\' COLLATE NOCASE] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CollateExpression(
                query_location=18446744073709551615,
                type='COLLATE',
                clazz='COLLATE',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                type_info=None
                            ),
                            value='hello',
                            is_null=False
                        )
                    )
                ),
                collation='NOCASE'
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT * FROM frogs USING SAMPLE 1% (BERNOULLI);] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=7,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                relation_name='',
                exclude_list=[],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=None,
    sample=SampleOptions(
        query_location=None,
        sample_size=Value(
            query_location=None,
            type=LogicalType(query_location=None, id=<LogicalTypeId.DOUBLE: 'DOUBLE'>, type_info=None),
            value=1.0,
            is_null=False
        ),
        is_percentage=True,
        method=<SampleMethod.BERNOULLI_SAMPLE: 'Bernoulli'>,
        seed=-1
    ),
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=14,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='frogs',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[SELECT 0::HUGEINT] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=8,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=0,
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(query_location=None, id=<LogicalTypeId.HUGEINT: 'HUGEINT'>, type_info=None),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT 0::UNION(num INT, str VARCHAR)] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=8,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=0,
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(
                    query_location=None,
                    id=<LogicalTypeId.UNION: 'UNION'>,
                    type_info=StructTypeInfo(
                        query_location=None,
                        type='STRUCT_TYPE_INFO',
                        alias='',
                        catalog_entry=None,
                        modifiers=[],
                        child_types=[
                            FirstSecond[str, LogicalType](
                                first='',
                                second=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.UTINYINT: 'UTINYINT'>,
                                    type_info=None
                                )
                            ),
                            FirstSecond[str, LogicalType](
                                first='num',
                                second=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                )
                            ),
                            FirstSecond[str, LogicalType](
                                first='str',
                                second=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                    type_info=None
                                )
                            )
                        ]
                    )
                ),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT 1 < 1, 1 <= 2] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=9,
                type='COMPARE_LESSTHAN',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=1,
                            is_null=False
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=11,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=1,
                            is_null=False
                        )
                    )
                )
            )
        ),
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=16,
                type='COMPARE_LESSTHANOREQUALTO',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=14,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=1,
                            is_null=False
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=19,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=2,
                            is_null=False
                        )
                    )
                )
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT 2 < 3, 2 > 3, 2 <= 3, 4 >= NULL, NULL = NULL, 2 <> 2] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=9,
                type='COMPARE_LESSTHAN',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=2,
                            is_null=False
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=11,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=3,
                            is_null=False
                        )
                    )
                )
            )
        ),
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=16,
                type='COMPARE_GREATERTHAN',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=14,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=2,
                            is_null=False
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=18,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=3,
                            is_null=False
                        )
                    )
                )
            )
        ),
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=23,
                type='COMPARE_LESSTHANOREQUALTO',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=21,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=2,
                            is_null=False
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=26,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=3,
                            is_null=False
                        )
                    )
                )
            )
        ),
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=31,
                type='COMPARE_GREATERTHANOREQUALTO',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=29,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=4,
                            is_null=False
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=34,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(query_location=None, id=<LogicalTypeId.NULL: 'NULL'>, type_info=None),
                            value=None,
                            is_null=True
                        )
                    )
                )
            )
        ),
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=45,
                type='COMPARE_EQUAL',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=40,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(query_location=None, id=<LogicalTypeId.NULL: 'NULL'>, type_info=None),
                            value=None,
                            is_null=True
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=47,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(query_location=None, id=<LogicalTypeId.NULL: 'NULL'>, type_info=None),
                            value=None,
                            is_null=True
                        )
                    )
                )
            )
        ),
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=55,
                type='COMPARE_NOTEQUAL',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=53,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=2,
                            is_null=False
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=58,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=2,
                            is_null=False
                        )
                    )
                )
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT 2 IS DISTINCT FROM NULL, NULL IS NOT DISTINCT FROM NULL] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=9,
                type='COMPARE_DISTINCT_FROM',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=2,
                            is_null=False
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=26,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(query_location=None, id=<LogicalTypeId.NULL: 'NULL'>, type_info=None),
                            value=None,
                            is_null=True
                        )
                    )
                )
            )
        ),
        ParsedExpressionSubclasses(
            root=ComparisonExpression(
                query_location=37,
                type='COMPARE_NOT_DISTINCT_FROM',
                clazz='COMPARISON',
                alias='',
                left=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=32,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(query_location=None, id=<LogicalTypeId.NULL: 'NULL'>, type_info=None),
                            value=None,
                            is_null=True
                        )
                    )
                ),
                right=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=58,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(query_location=None, id=<LogicalTypeId.NULL: 'NULL'>, type_info=None),
                            value=None,
                            is_null=True
                        )
                    )
                )
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT DATE \'1992-09-20\'] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=18446744073709551615,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=12,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                type_info=None
                            ),
                            value='1992-09-20',
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(query_location=None, id=<LogicalTypeId.DATE: 'DATE'>, type_info=None),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT EXISTS(SELECT * FROM grades WHERE course=\'Math\');] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=SubqueryExpression(
                query_location=7,
                type='SUBQUERY',
                clazz='SUBQUERY',
                alias='',
                child=None,
                comparison_type='INVALID',
                subquery=SelectStatement(
                    query_location=None,
                    node=QueryNodeSubclasses(
                        root=SelectNode(
                            query_location=None,
                            type='SELECT_NODE',
                            modifiers=[],
                            cte_map=CommonTableExpressionMap(
                                query_location=None,
                                map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                            ),
                            select_list=[
                                ParsedExpressionSubclasses(
                                    root=StarExpression(
                                        query_location=21,
                                        type='STAR',
                                        clazz='STAR',
                                        alias='',
                                        columns=False,
                                        replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                                        relation_name='',
                                        exclude_list=[],
                                        expr=None,
                                        unpacked=False
                                    )
                                )
                            ],
                            where_clause=ParsedExpressionSubclasses(
                                root=ComparisonExpression(
                                    query_location=47,
                                    type='COMPARE_EQUAL',
                                    clazz='COMPARISON',
                                    alias='',
                                    left=ParsedExpressionSubclasses(
                                        root=ColumnRefExpression(
                                            query_location=41,
                                            type='COLUMN_REF',
                                            clazz='COLUMN_REF',
                                            alias='',
                                            column_names=['course']
                                        )
                                    ),
                                    right=ParsedExpressionSubclasses(
                                        root=ConstantExpression(
                                            query_location=48,
                                            type='VALUE_CONSTANT',
                                            clazz='CONSTANT',
                                            alias='',
                                            value=Value(
                                                query_location=None,
                                                type=LogicalType(
                                                    query_location=None,
                                                    id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                                    type_info=None
                                                ),
                                                value='Math',
                                                is_null=False
                                            )
                                        )
                                    )
                                )
                            ),
                            sample=None,
                            qualify=None,
                            having=None,
                            group_sets=[],
                            group_expressions=[],
                            aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
                            from_table=TableRefSubclasses(
                                root=BaseTableRef(
                                    query_location=28,
                                    alias='',
                                    sample=None,
                                    type='BASE_TABLE',
                                    schema_name='',
                                    table_name='grades',
                                    catalog_name='',
                                    column_name_alias=[]
                                )
                            )
                        )
                    )
                ),
                subquery_type='EXISTS'
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT INTERVAL 1 YEAR] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=18446744073709551615,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='to_years',
                catalog='',
                is_operator=False,
                children=[
                    ParsedExpressionSubclasses(
                        root=CastExpression(
                            query_location=18446744073709551615,
                            type='OPERATOR_CAST',
                            clazz='CAST',
                            alias='',
                            child=ParsedExpressionSubclasses(
                                root=FunctionExpression(
                                    query_location=18446744073709551615,
                                    type='FUNCTION',
                                    clazz='FUNCTION',
                                    alias='',
                                    schema_name='',
                                    function_name='trunc',
                                    catalog='',
                                    is_operator=False,
                                    children=[
                                        ParsedExpressionSubclasses(
                                            root=CastExpression(
                                                query_location=18446744073709551615,
                                                type='OPERATOR_CAST',
                                                clazz='CAST',
                                                alias='',
                                                child=ParsedExpressionSubclasses(
                                                    root=ConstantExpression(
                                                        query_location=18446744073709551615,
                                                        type='VALUE_CONSTANT',
                                                        clazz='CONSTANT',
                                                        alias='',
                                                        value=Value(
                                                            query_location=None,
                                                            type=LogicalType(
                                                                query_location=None,
                                                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                                type_info=None
                                                            ),
                                                            value=1,
                                                            is_null=False
                                                        )
                                                    )
                                                ),
                                                cast_type=LogicalType(
                                                    query_location=None,
                                                    id=<LogicalTypeId.DOUBLE: 'DOUBLE'>,
                                                    type_info=None
                                                ),
                                                try_cast=False
                                            )
                                        )
                                    ],
                                    distinct=False,
                                    order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                                    export_state=False,
                                    filter=None
                                )
                            ),
                            cast_type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            try_cast=False
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT MIN(COLUMNS(*)), COUNT(COLUMNS(*)) from numbers;] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=7,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='min',
                catalog='',
                is_operator=False,
                children=[
                    ParsedExpressionSubclasses(
                        root=StarExpression(
                            query_location=11,
                            type='STAR',
                            clazz='STAR',
                            alias='',
                            columns=True,
                            replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                            relation_name='',
                            exclude_list=[],
                            expr=None,
                            unpacked=False
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        ),
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=24,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='count',
                catalog='',
                is_operator=False,
                children=[
                    ParsedExpressionSubclasses(
                        root=StarExpression(
                            query_location=30,
                            type='STAR',
                            clazz='STAR',
                            alias='',
                            columns=True,
                            replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                            relation_name='',
                            exclude_list=[],
                            expr=None,
                            unpacked=False
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=47,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='numbers',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[SELECT NULL IS NULL] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=12,
                type='OPERATOR_IS_NULL',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=7,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(query_location=None, id=<LogicalTypeId.NULL: 'NULL'>, type_info=None),
                                value=None,
                                is_null=True
                            )
                        )
                    )
                ]
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT TIMESTAMP \'1992-09-20 11:30:00\'] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=18446744073709551615,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=17,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                type_info=None
                            ),
                            value='1992-09-20 11:30:00',
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(query_location=None, id=<LogicalTypeId.TIMESTAMP: 'TIMESTAMP'>, type_info=None),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT TIMESTAMPTZ \'1992-09-20 11:30:00\'] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=18446744073709551615,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=19,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                type_info=None
                            ),
                            value='1992-09-20 11:30:00',
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(
                    query_location=None,
                    id=<LogicalTypeId.TIMESTAMP_TZ: 'TIMESTAMP WITH TIME ZONE'>,
                    type_info=None
                ),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT a BETWEEN x AND y] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=BetweenExpression(
                query_location=9,
                type='COMPARE_BETWEEN',
                clazz='BETWEEN',
                alias='',
                input=ParsedExpressionSubclasses(
                    root=ColumnRefExpression(
                        query_location=7,
                        type='COLUMN_REF',
                        clazz='COLUMN_REF',
                        alias='',
                        column_names=['a']
                    )
                ),
                lower=ParsedExpressionSubclasses(
                    root=ColumnRefExpression(
                        query_location=17,
                        type='COLUMN_REF',
                        clazz='COLUMN_REF',
                        alias='',
                        column_names=['x']
                    )
                ),
                upper=ParsedExpressionSubclasses(
                    root=ColumnRefExpression(
                        query_location=23,
                        type='COLUMN_REF',
                        clazz='COLUMN_REF',
                        alias='',
                        column_names=['y']
                    )
                )
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT a NOT BETWEEN x AND y] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=9,
                type='OPERATOR_NOT',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=BetweenExpression(
                            query_location=18446744073709551615,
                            type='COMPARE_BETWEEN',
                            clazz='BETWEEN',
                            alias='',
                            input=ParsedExpressionSubclasses(
                                root=ColumnRefExpression(
                                    query_location=7,
                                    type='COLUMN_REF',
                                    clazz='COLUMN_REF',
                                    alias='',
                                    column_names=['a']
                                )
                            ),
                            lower=ParsedExpressionSubclasses(
                                root=ColumnRefExpression(
                                    query_location=21,
                                    type='COLUMN_REF',
                                    clazz='COLUMN_REF',
                                    alias='',
                                    column_names=['x']
                                )
                            ),
                            upper=ParsedExpressionSubclasses(
                                root=ColumnRefExpression(
                                    query_location=27,
                                    type='COLUMN_REF',
                                    clazz='COLUMN_REF',
                                    alias='',
                                    column_names=['y']
                                )
                            )
                        )
                    )
                ]
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT a.* FROM (SELECT {\'x\':1, \'y\':2, \'z\':3} as a);] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=7,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                relation_name='a',
                exclude_list=[],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=SubqueryRef(
            query_location=18446744073709551615,
            alias='',
            sample=None,
            type='SUBQUERY',
            subquery=SelectStatement(
                query_location=None,
                node=QueryNodeSubclasses(
                    root=SelectNode(
                        query_location=None,
                        type='SELECT_NODE',
                        modifiers=[],
                        cte_map=CommonTableExpressionMap(
                            query_location=None,
                            map=OrderedDict[str, CommonTableExpressionInfo](root=[])
                        ),
                        select_list=[
                            ParsedExpressionSubclasses(
                                root=FunctionExpression(
                                    query_location=25,
                                    type='FUNCTION',
                                    clazz='FUNCTION',
                                    alias='a',
                                    schema_name='main',
                                    function_name='struct_pack',
                                    catalog='',
                                    is_operator=False,
                                    children=[
                                        ParsedExpressionSubclasses(
                                            root=ConstantExpression(
                                                query_location=29,
                                                type='VALUE_CONSTANT',
                                                clazz='CONSTANT',
                                                alias='x',
                                                value=Value(
                                                    query_location=None,
                                                    type=LogicalType(
                                                        query_location=None,
                                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                        type_info=None
                                                    ),
                                                    value=1,
                                                    is_null=False
                                                )
                                            )
                                        ),
                                        ParsedExpressionSubclasses(
                                            root=ConstantExpression(
                                                query_location=36,
                                                type='VALUE_CONSTANT',
                                                clazz='CONSTANT',
                                                alias='y',
                                                value=Value(
                                                    query_location=None,
                                                    type=LogicalType(
                                                        query_location=None,
                                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                        type_info=None
                                                    ),
                                                    value=2,
                                                    is_null=False
                                                )
                                            )
                                        ),
                                        ParsedExpressionSubclasses(
                                            root=ConstantExpression(
                                                query_location=43,
                                                type='VALUE_CONSTANT',
                                                clazz='CONSTANT',
                                                alias='z',
                                                value=Value(
                                                    query_location=None,
                                                    type=LogicalType(
                                                        query_location=None,
                                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                        type_info=None
                                                    ),
                                                    value=3,
                                                    is_null=False
                                                )
                                            )
                                        )
                                    ],
                                    distinct=False,
                                    order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                                    export_state=False,
                                    filter=None
                                )
                            )
                        ],
                        where_clause=None,
                        sample=None,
                        qualify=None,
                        having=None,
                        group_sets=[],
                        group_expressions=[],
                        aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
                        from_table=TableRefSubclasses(
                            root=EmptyTableRef(
                                query_location=18446744073709551615,
                                alias='',
                                sample=None,
                                type='EMPTY'
                            )
                        )
                    )
                )
            ),
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[SELECT expression IS NOT NULL] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=OperatorExpression(
                query_location=18,
                type='OPERATOR_IS_NOT_NULL',
                clazz='OPERATOR',
                alias='',
                children=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=7,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['expression']
                        )
                    )
                ]
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT i, CASE WHEN i>2 THEN 1 ELSE 0 END AS test FROM integers] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=7,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['i']
            )
        ),
        ParsedExpressionSubclasses(
            root=CaseExpression(
                query_location=10,
                type='CASE_EXPR',
                clazz='CASE',
                alias='test',
                case_checks=[
                    CaseCheck(
                        query_location=None,
                        when_expr=ParsedExpressionSubclasses(
                            root=ComparisonExpression(
                                query_location=21,
                                type='COMPARE_GREATERTHAN',
                                clazz='COMPARISON',
                                alias='',
                                left=ParsedExpressionSubclasses(
                                    root=ColumnRefExpression(
                                        query_location=20,
                                        type='COLUMN_REF',
                                        clazz='COLUMN_REF',
                                        alias='',
                                        column_names=['i']
                                    )
                                ),
                                right=ParsedExpressionSubclasses(
                                    root=ConstantExpression(
                                        query_location=22,
                                        type='VALUE_CONSTANT',
                                        clazz='CONSTANT',
                                        alias='',
                                        value=Value(
                                            query_location=None,
                                            type=LogicalType(
                                                query_location=None,
                                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                type_info=None
                                            ),
                                            value=2,
                                            is_null=False
                                        )
                                    )
                                )
                            )
                        ),
                        then_expr=ParsedExpressionSubclasses(
                            root=ConstantExpression(
                                query_location=29,
                                type='VALUE_CONSTANT',
                                clazz='CONSTANT',
                                alias='',
                                value=Value(
                                    query_location=None,
                                    type=LogicalType(
                                        query_location=None,
                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                        type_info=None
                                    ),
                                    value=1,
                                    is_null=False
                                )
                            )
                        )
                    )
                ],
                else_expr=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=36,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=0,
                            is_null=False
                        )
                    )
                )
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=55,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='integers',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[SELECT list_map(x -> x * 2)] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=7,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='list_map',
                catalog='',
                is_operator=False,
                children=[
                    ParsedExpressionSubclasses(
                        root=LambdaExpression(
                            query_location=18,
                            type='LAMBDA',
                            clazz='LAMBDA',
                            alias='',
                            lhs=ParsedExpressionSubclasses(
                                root=ColumnRefExpression(
                                    query_location=16,
                                    type='COLUMN_REF',
                                    clazz='COLUMN_REF',
                                    alias='',
                                    column_names=['x']
                                )
                            ),
                            expr=ParsedExpressionSubclasses(
                                root=FunctionExpression(
                                    query_location=23,
                                    type='FUNCTION',
                                    clazz='FUNCTION',
                                    alias='',
                                    schema_name='',
                                    function_name='*',
                                    catalog='',
                                    is_operator=True,
                                    children=[
                                        ParsedExpressionSubclasses(
                                            root=ColumnRefExpression(
                                                query_location=21,
                                                type='COLUMN_REF',
                                                clazz='COLUMN_REF',
                                                alias='',
                                                column_names=['x']
                                            )
                                        ),
                                        ParsedExpressionSubclasses(
                                            root=ConstantExpression(
                                                query_location=25,
                                                type='VALUE_CONSTANT',
                                                clazz='CONSTANT',
                                                alias='',
                                                value=Value(
                                                    query_location=None,
                                                    type=LogicalType(
                                                        query_location=None,
                                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                        type_info=None
                                                    ),
                                                    value=2,
                                                    is_null=False
                                                )
                                            )
                                        )
                                    ],
                                    distinct=False,
                                    order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                                    export_state=False,
                                    filter=None
                                )
                            )
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[SELECT row_number() OVER () FROM sales;] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=WindowExpression(
                query_location=7,
                type='WINDOW_ROW_NUMBER',
                clazz='WINDOW',
                alias='',
                catalog='',
                schema_name='',
                function_name='row_number',
                children=[],
                partitions=[],
                orders=[],
                filter_expr=None,
                ignore_nulls=False,
                start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                start_expr=None,
                end_expr=None,
                offset_expr=None,
                default_expr=None,
                exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                distinct=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=33,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='sales',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[SELECT row_number() OVER (ORDER BY time) FROM sales;] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=WindowExpression(
                query_location=7,
                type='WINDOW_ROW_NUMBER',
                clazz='WINDOW',
                alias='',
                catalog='',
                schema_name='',
                function_name='row_number',
                children=[],
                partitions=[],
                orders=[
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=35,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['time']
                            )
                        )
                    )
                ],
                filter_expr=None,
                ignore_nulls=False,
                start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                start_expr=None,
                end_expr=None,
                offset_expr=None,
                default_expr=None,
                exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                distinct=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=46,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='sales',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[SELECT row_number() OVER (PARTITION BY region ORDER BY time) FROM sales;] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=WindowExpression(
                query_location=7,
                type='WINDOW_ROW_NUMBER',
                clazz='WINDOW',
                alias='',
                catalog='',
                schema_name='',
                function_name='row_number',
                children=[],
                partitions=[
                    ParsedExpressionSubclasses(
                        root=ColumnRefExpression(
                            query_location=39,
                            type='COLUMN_REF',
                            clazz='COLUMN_REF',
                            alias='',
                            column_names=['region']
                        )
                    )
                ],
                orders=[
                    OrderByNode(
                        query_location=None,
                        type=<OrderType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        null_order=<OrderByNullType.ORDER_DEFAULT: 'ORDER_DEFAULT'>,
                        expression=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=55,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['time']
                            )
                        )
                    )
                ],
                filter_expr=None,
                ignore_nulls=False,
                start=<WindowBoundary.UNBOUNDED_PRECEDING: 'UNBOUNDED_PRECEDING'>,
                end=<WindowBoundary.CURRENT_ROW_RANGE: 'CURRENT_ROW_RANGE'>,
                start_expr=None,
                end_expr=None,
                offset_expr=None,
                default_expr=None,
                exclude_clause=<WindowExcludeMode.NO_OTHER: 'NO_OTHER'>,
                distinct=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=66,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='sales',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[select * from duckdb_tables] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=7,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                relation_name='',
                exclude_list=[],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=14,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='duckdb_tables',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[select * from range(0, 10)] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=7,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                relation_name='',
                exclude_list=[],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=TableFunctionRef(
            query_location=14,
            alias='',
            sample=None,
            type='TABLE_FUNCTION',
            function=FunctionExpression(
                query_location=14,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='range',
                catalog='',
                is_operator=False,
                children=[
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=20,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                ),
                                value=0,
                                is_null=False
                            )
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=23,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                ),
                                value=10,
                                is_null=False
                            )
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            ),
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[select 0::DECIMAL(15, 6)] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=8,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=0,
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(
                    query_location=None,
                    id=<LogicalTypeId.DECIMAL: 'DECIMAL'>,
                    type_info=DecimalTypeInfo(
                        query_location=None,
                        type='DECIMAL_TYPE_INFO',
                        alias='',
                        catalog_entry=None,
                        modifiers=[],
                        width=15,
                        scale=6
                    )
                ),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[select 0::STRUCT(a INT)] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=8,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=0,
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(
                    query_location=None,
                    id=<LogicalTypeId.STRUCT: 'STRUCT'>,
                    type_info=StructTypeInfo(
                        query_location=None,
                        type='STRUCT_TYPE_INFO',
                        alias='',
                        catalog_entry=None,
                        modifiers=[],
                        child_types=[
                            FirstSecond[str, LogicalType](
                                first='a',
                                second=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                )
                            )
                        ]
                    )
                ),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[select 0::USER_TYPE] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=8,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=ConstantExpression(
                        query_location=7,
                        type='VALUE_CONSTANT',
                        clazz='CONSTANT',
                        alias='',
                        value=Value(
                            query_location=None,
                            type=LogicalType(
                                query_location=None,
                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                type_info=None
                            ),
                            value=0,
                            is_null=False
                        )
                    )
                ),
                cast_type=LogicalType(
                    query_location=None,
                    id=<LogicalTypeId.USER: 'USER'>,
                    type_info=UserTypeInfo(
                        query_location=None,
                        type='USER_TYPE_INFO',
                        alias='',
                        catalog_entry=None,
                        modifiers=[],
                        user_type_name='USER_TYPE',
                        schema_name='',
                        catalog='',
                        user_type_modifiers=[]
                    )
                ),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[select 1 * 1] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=9,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='*',
                catalog='',
                is_operator=True,
                children=[
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=7,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                ),
                                value=1,
                                is_null=False
                            )
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=ConstantExpression(
                            query_location=11,
                            type='VALUE_CONSTANT',
                            clazz='CONSTANT',
                            alias='',
                            value=Value(
                                query_location=None,
                                type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                    type_info=None
                                ),
                                value=1,
                                is_null=False
                            )
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[select 1] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ConstantExpression(
                query_location=7,
                type='VALUE_CONSTANT',
                clazz='CONSTANT',
                alias='',
                value=Value(
                    query_location=None,
                    type=LogicalType(query_location=None, id=<LogicalTypeId.INTEGER: 'INTEGER'>, type_info=None),
                    value=1,
                    is_null=False
                )
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[select []::boolean[]] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=CastExpression(
                query_location=9,
                type='OPERATOR_CAST',
                clazz='CAST',
                alias='',
                child=ParsedExpressionSubclasses(
                    root=FunctionExpression(
                        query_location=18446744073709551615,
                        type='FUNCTION',
                        clazz='FUNCTION',
                        alias='',
                        schema_name='main',
                        function_name='list_value',
                        catalog='',
                        is_operator=False,
                        children=[],
                        distinct=False,
                        order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                        export_state=False,
                        filter=None
                    )
                ),
                cast_type=LogicalType(
                    query_location=None,
                    id=<LogicalTypeId.LIST: 'LIST'>,
                    type_info=ListTypeInfo(
                        query_location=None,
                        type='LIST_TYPE_INFO',
                        alias='',
                        catalog_entry=None,
                        modifiers=[],
                        child_type=LogicalType(
                            query_location=None,
                            id=<LogicalTypeId.BOOLEAN: 'BOOLEAN'>,
                            type_info=None
                        )
                    )
                ),
                try_cast=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[select frog from frogs where height > 5 and leader = true] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=7,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['frog']
            )
        )
    ],
    where_clause=ParsedExpressionSubclasses(
        root=ConjunctionExpression(
            query_location=40,
            type='CONJUNCTION_AND',
            clazz='CONJUNCTION',
            alias='',
            children=[
                ParsedExpressionSubclasses(
                    root=ComparisonExpression(
                        query_location=36,
                        type='COMPARE_GREATERTHAN',
                        clazz='COMPARISON',
                        alias='',
                        left=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=29,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['height']
                            )
                        ),
                        right=ParsedExpressionSubclasses(
                            root=ConstantExpression(
                                query_location=38,
                                type='VALUE_CONSTANT',
                                clazz='CONSTANT',
                                alias='',
                                value=Value(
                                    query_location=None,
                                    type=LogicalType(
                                        query_location=None,
                                        id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                        type_info=None
                                    ),
                                    value=5,
                                    is_null=False
                                )
                            )
                        )
                    )
                ),
                ParsedExpressionSubclasses(
                    root=ComparisonExpression(
                        query_location=51,
                        type='COMPARE_EQUAL',
                        clazz='COMPARISON',
                        alias='',
                        left=ParsedExpressionSubclasses(
                            root=ColumnRefExpression(
                                query_location=44,
                                type='COLUMN_REF',
                                clazz='COLUMN_REF',
                                alias='',
                                column_names=['leader']
                            )
                        ),
                        right=ParsedExpressionSubclasses(
                            root=CastExpression(
                                query_location=18446744073709551615,
                                type='OPERATOR_CAST',
                                clazz='CAST',
                                alias='',
                                child=ParsedExpressionSubclasses(
                                    root=ConstantExpression(
                                        query_location=53,
                                        type='VALUE_CONSTANT',
                                        clazz='CONSTANT',
                                        alias='',
                                        value=Value(
                                            query_location=None,
                                            type=LogicalType(
                                                query_location=None,
                                                id=<LogicalTypeId.VARCHAR: 'VARCHAR'>,
                                                type_info=None
                                            ),
                                            value='t',
                                            is_null=False
                                        )
                                    )
                                ),
                                cast_type=LogicalType(
                                    query_location=None,
                                    id=<LogicalTypeId.BOOLEAN: 'BOOLEAN'>,
                                    type_info=None
                                ),
                                try_cast=False
                            )
                        )
                    )
                )
            ]
        )
    ),
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=17,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='frogs',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[select frog from frogs] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=7,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['frog']
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=17,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='frogs',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[select frog.* EXCLUDE age from frogs] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=StarExpression(
                query_location=7,
                type='STAR',
                clazz='STAR',
                alias='',
                columns=False,
                replace_list=OrderedDict[str, ParsedExpressionSubclasses](root=[]),
                relation_name='frog',
                exclude_list=['age'],
                expr=None,
                unpacked=False
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=31,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='frogs',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[select frog.age from frogs] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=7,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['frog', 'age']
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=21,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='frogs',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql[select list_apply([1, 2, 3], x => x * 2)] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=FunctionExpression(
                query_location=7,
                type='FUNCTION',
                clazz='FUNCTION',
                alias='',
                schema_name='',
                function_name='list_apply',
                catalog='',
                is_operator=False,
                children=[
                    ParsedExpressionSubclasses(
                        root=FunctionExpression(
                            query_location=19,
                            type='FUNCTION',
                            clazz='FUNCTION',
                            alias='',
                            schema_name='main',
                            function_name='list_value',
                            catalog='',
                            is_operator=False,
                            children=[
                                ParsedExpressionSubclasses(
                                    root=ConstantExpression(
                                        query_location=19,
                                        type='VALUE_CONSTANT',
                                        clazz='CONSTANT',
                                        alias='',
                                        value=Value(
                                            query_location=None,
                                            type=LogicalType(
                                                query_location=None,
                                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                type_info=None
                                            ),
                                            value=1,
                                            is_null=False
                                        )
                                    )
                                ),
                                ParsedExpressionSubclasses(
                                    root=ConstantExpression(
                                        query_location=22,
                                        type='VALUE_CONSTANT',
                                        clazz='CONSTANT',
                                        alias='',
                                        value=Value(
                                            query_location=None,
                                            type=LogicalType(
                                                query_location=None,
                                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                type_info=None
                                            ),
                                            value=2,
                                            is_null=False
                                        )
                                    )
                                ),
                                ParsedExpressionSubclasses(
                                    root=ConstantExpression(
                                        query_location=25,
                                        type='VALUE_CONSTANT',
                                        clazz='CONSTANT',
                                        alias='',
                                        value=Value(
                                            query_location=None,
                                            type=LogicalType(
                                                query_location=None,
                                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                type_info=None
                                            ),
                                            value=3,
                                            is_null=False
                                        )
                                    )
                                )
                            ],
                            distinct=False,
                            order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                            export_state=False,
                            filter=None
                        )
                    ),
                    ParsedExpressionSubclasses(
                        root=FunctionExpression(
                            query_location=36,
                            type='FUNCTION',
                            clazz='FUNCTION',
                            alias='x',
                            schema_name='',
                            function_name='*',
                            catalog='',
                            is_operator=True,
                            children=[
                                ParsedExpressionSubclasses(
                                    root=ColumnRefExpression(
                                        query_location=34,
                                        type='COLUMN_REF',
                                        clazz='COLUMN_REF',
                                        alias='',
                                        column_names=['x']
                                    )
                                ),
                                ParsedExpressionSubclasses(
                                    root=ConstantExpression(
                                        query_location=38,
                                        type='VALUE_CONSTANT',
                                        clazz='CONSTANT',
                                        alias='',
                                        value=Value(
                                            query_location=None,
                                            type=LogicalType(
                                                query_location=None,
                                                id=<LogicalTypeId.INTEGER: 'INTEGER'>,
                                                type_info=None
                                            ),
                                            value=2,
                                            is_null=False
                                        )
                                    )
                                )
                            ],
                            distinct=False,
                            order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                            export_state=False,
                            filter=None
                        )
                    )
                ],
                distinct=False,
                order_bys=OrderModifier(query_location=None, type='ORDER_MODIFIER', orders=[]),
                export_state=False,
                filter=None
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[],
    group_expressions=[],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=EmptyTableRef(query_location=18446744073709551615, alias='', sample=None, type='EMPTY')
    )
)
'''

snapshots['test_sql[select name from frogs GROUP BY age] 1'] = '''SelectNode(
    query_location=None,
    type='SELECT_NODE',
    modifiers=[],
    cte_map=CommonTableExpressionMap(query_location=None, map=OrderedDict[str, CommonTableExpressionInfo](root=[])),
    select_list=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=7,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['name']
            )
        )
    ],
    where_clause=None,
    sample=None,
    qualify=None,
    having=None,
    group_sets=[{0}],
    group_expressions=[
        ParsedExpressionSubclasses(
            root=ColumnRefExpression(
                query_location=32,
                type='COLUMN_REF',
                clazz='COLUMN_REF',
                alias='',
                column_names=['age']
            )
        )
    ],
    aggregate_handling=<AggregateHandling.STANDARD_HANDLING: 'STANDARD_HANDLING'>,
    from_table=TableRefSubclasses(
        root=BaseTableRef(
            query_location=17,
            alias='',
            sample=None,
            type='BASE_TABLE',
            schema_name='',
            table_name='frogs',
            catalog_name='',
            column_name_alias=[]
        )
    )
)
'''

snapshots['test_sql_errors[CREATE TYPE my_type AS (a INT, b VARCHAR)] 1'] = '''ErrorResponse(
    query_location=None,
    error=True,
    error_message=\'syntax error at or near "("\',
    error_type='parser',
    error_subtype='SYNTAX_ERROR',
    position=23
)
'''

snapshots['test_sql_errors[select] 1'] = '''ErrorResponse(
    query_location=None,
    error=True,
    error_message='SELECT clause without selection list',
    error_type='parser',
    error_subtype=None,
    position=None
)
'''

snapshots['test_sql_errors[set threads = 5] 1'] = '''ErrorResponse(
    query_location=None,
    error=True,
    error_message='Only SELECT statements can be serialized to json!',
    error_type='not implemented',
    error_subtype=None,
    position=None
)
'''
